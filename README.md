# `opencv_annmlp_testNN_MLP` 测试例子

- 该项目有两个分支
- `master`  
`master`分支是`3.1.0`版本库的例子。
- `opencv249_annmlp`  
该分支是`2.4.9`版本库的例子。

- 使用方法
- 首先需要安装对应版本的`opencv`库。修改`install_opencv`内的`opencv`版本信息，然后执行安装脚本工具`install_opencv.sh`。  
- 执行`make`即可编译项目.   
- 项目使用`picture`文件夹中的图片作为训练用的数据。
- 生成的`ANN_MLP` 只有在`row*col`小于255的时候才能正常呗`ive_tool_xml2bin_ui.exe`转换。

#海思数据格式与opencv数据格式之间区别

- 海思数据格式是HI_S16Q16，意思是高16位表示整数，低16位表示浮点数。共占据32位。在使用opencv生成model的时候，opencv所接受的数据就是正常的浮点数，不需要进行额外的转换。
- 海思的ive api进行predict时，所接受的输入并不是图像的像素信息，而是对像素信息进行分块处理后的一个映射表。所以在生成model的时候输入的信息也需要是按照相同方式转换的一个映射表。
- 原本以为海思不能输入大于`width*height`大于255的图像，后来发现了上面那一点后才发现，原来可以把`16*32`的图形按照上诉方式进行转换就变成了`4*8`的图像信息。    


# opencv训练时的注意点
- 海思训练model时输入的图像信息并不是直接输入，而是按照`4*4`的块区域取平均值的方式进行输入。这样一个原本是`16*32`的图像信息就转换成了`4*8`的浮点数数组。如果图像大还可以加大step(即上面的`4*4`的4)的值，只要保证最后数组大小在`width*height < 255`即可。  
